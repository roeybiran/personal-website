---
import { getEntry } from "astro:content";
import AppLayout from "../../../layouts/AppLayout.astro";
import { extractAppNameFromURL } from "../../../utils/extractAppNameFromURL";
import Fallback from "../../../components/Fallback.astro";
import { getTextFile } from "../../../utils/s3";

const url = Astro.request.url;
const slug = extractAppNameFromURL(url);
const entry = await getEntry("apps", slug);
if (!entry) {
  return Astro.redirect("/404");
}

const content = await getTextFile(slug, `${entry.data.name}.html`);
---

<AppLayout entry={entry} pageTitle="Release Notes" currentURL={url}>
  <h1 class="sr-only">{entry.data.name}: Release Notes</h1>
  <div class="release-notes | constrained padded prose" set:html={content}>
    {content ? null : <Fallback fallbackText="No release notes yet." />}
  </div>
</AppLayout>
